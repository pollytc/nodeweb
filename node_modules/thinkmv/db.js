/**
 * Created by Administrator on 2016/12/9.
 */
var settings = require('./config'),
    Mongo = require('mongodb').Db,
    Connection = require('mongodb').Connection,
    Server = require('mongodb').Server;
var mongo = new Mongo(settings.db, new Server(settings.host, settings.port),{safe: true});
var proto = module.exports={};
var gdb = null;
proto.openDB=function(){
    mongo.open(function (err,db) {
        if(err){
            throw new Error('monogodb cannot connet');
        }else{
            gdb = db;
        }
    })
}
proto.settings =settings;
proto.closeDB = function(){
    mongo.close();
    console.log('close db');
}

proto.getDBByTable = function (table,back) {
    gdb.collection(table,function(err,t){
        if(err)back(err);
        else back(null,t);
    })
}
proto.getDBCount = function (table,back) {

}
proto.openDB();